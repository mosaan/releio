# 段階的移行ロードマップ

既存プロジェクトにSDD準拠アーティファクトを段階的に導入する計画策定ガイド。

## 移行の基本原則

### 1. ビッグバンを避ける

一度にすべてを文書化しようとしない。

```
❌ 悪い例: 「来月までに全アーティファクトを完成させる」
✅ 良い例: 「今月は最重要3ドメインのGlossaryを作成する」
```

### 2. 価値駆動で進める

「完璧な文書化」ではなく「今すぐ役立つ文書化」を優先。

```
❌ 悪い例: 「全APIを網羅したOpenAPI仕様書を作る」
✅ 良い例: 「外部公開APIの仕様書を先に作る」
```

### 3. 日常業務に組み込む

特別プロジェクトではなく、通常の開発フローに統合。

```
❌ 悪い例: 「文書化専任チームを作る」
✅ 良い例: 「PRレビュー時にGlossary更新を確認する」
```

---

## MVP（最小限文書化セット）の定義

「これだけは最低限必要」という最小セット。

### MVP Level 1: 生存ライン（1-2週間）

新メンバーがプロジェクトを理解できる最低限。

```markdown
## MVP Level 1 チェックリスト

### 必須
- [ ] Domain Vision Statement（1ページ）
  - What/Why/Scope だけでOK
- [ ] Core Glossary（10-15用語）
  - 最重要エンティティのみ
  - 定義と型だけでOK（invariantsは後）
- [ ] Context Map（概要レベル）
  - BC名と主要な関係のみ
  - 詳細な統合パターンは後

### 所要時間目安
- 準備: 1日（既存資料の収集）
- 作成: 2-3日
- レビュー: 1日
- 合計: 約1週間
```

### MVP Level 2: 開発継続ライン（2-4週間）

新機能開発を効率的に進められるレベル。

```markdown
## MVP Level 2 チェックリスト

### Level 1に追加
- [ ] Glossary拡充（30-50用語）
  - 主要エンティティに invariants 追加
  - Value Objects, Enums を追加
- [ ] 主要ユースケースの User Stories（5-10個）
  - 最も頻繁に変更される機能
  - Given-When-Then 形式のAC
- [ ] 主要 API の OpenAPI 仕様
  - 外部連携API優先
  - 内部APIは後回し

### 所要時間目安
- 約2-3週間（通常業務と並行）
```

### MVP Level 3: 品質向上ライン（1-2ヶ月）

コード品質改善やリファクタリングの基盤。

```markdown
## MVP Level 3 チェックリスト

### Level 2に追加
- [ ] Domain Model（主要Aggregate）
  - Aggregate境界の明確化
  - 不変条件のコード化
- [ ] Domain Events の定義
  - 主要な状態遷移
  - イベントフロー図
- [ ] ADR（主要5-10件）
  - 技術選定の理由
  - 既知の技術的負債

### 所要時間目安
- 約1-2ヶ月（通常業務と並行）
```

### MVP Level 4: 完全準拠（3ヶ月以上）

SDD完全準拠、AI活用可能な状態。

```markdown
## MVP Level 4 チェックリスト

### Level 3に追加
- [ ] 全Glossary用語の完全定義
- [ ] 全User StoriesのFormal AC
- [ ] 全APIのOpenAPI仕様
- [ ] Data Model（論理/物理）
- [ ] 検証自動化（CI/CD統合）
- [ ] AI Prompt Template Registry

### 所要時間目安
- 3ヶ月以上（継続的改善）
```

---

## 移行ロードマップテンプレート

### フェーズ構成

```
┌─────────────────────────────────────────────────────────────┐
│ Phase 0: 準備・診断（1週間）                                │
│ - ギャップ診断                                              │
│ - ステークホルダー合意                                      │
│ - ツール準備                                                │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 1: MVP Level 1（1-2週間）                             │
│ - Domain Vision                                             │
│ - Core Glossary                                             │
│ - Context Map                                               │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 2: MVP Level 2（2-4週間）                             │
│ - Glossary拡充                                              │
│ - 主要User Stories                                          │
│ - 外部API仕様                                               │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 3: MVP Level 3（1-2ヶ月）                             │
│ - Domain Model                                              │
│ - Domain Events                                             │
│ - ADRs                                                      │
└─────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────────┐
│ Phase 4: 継続的改善（ongoing）                              │
│ - 完全準拠への漸進的移行                                    │
│ - 自動検証の導入                                            │
│ - チームプラクティスの定着                                  │
└─────────────────────────────────────────────────────────────┘
```

### 詳細ロードマップテンプレート

```markdown
# [プロジェクト名] SDD移行ロードマップ

## 概要

| 項目 | 内容 |
|------|------|
| 開始日 | YYYY-MM-DD |
| 目標MVP Level | Level __ |
| 目標達成日 | YYYY-MM-DD |
| 担当者 | [名前] |

## Phase 0: 準備・診断（Week 0）

### 目標
- ギャップ診断完了
- 移行計画の合意

### タスク
- [ ] ギャップ診断チェックリスト実施
- [ ] 優先順位スコアリング
- [ ] ステークホルダーへの説明・合意
- [ ] リポジトリ構造の準備
- [ ] テンプレートファイルの配置

### 成果物
- [ ] ギャップ診断レポート
- [ ] 本ロードマップ（承認済み）

### マイルストーン
- [ ] キックオフ完了

---

## Phase 1: 基盤構築（Week 1-2）

### 目標
- MVP Level 1 達成
- 新メンバーが参照できる最低限のドキュメント

### タスク

#### Week 1
- [ ] Domain Vision Statement 作成
  - 担当: [名前]
  - レビュアー: [名前]
- [ ] Core Glossary 抽出開始
  - 担当: [名前]
  - 対象: [主要ドメインクラス]

#### Week 2
- [ ] Core Glossary 完成（15用語）
- [ ] Context Map 作成
- [ ] Phase 1 レビュー会議

### 成果物
- [ ] domain/vision.md
- [ ] domain/glossary.yaml（15用語）
- [ ] architecture/context-map.md

### マイルストーン
- [ ] MVP Level 1 達成

### リスクと対策
| リスク | 対策 |
|--------|------|
| ドメインエキスパート不在 | 事前にインタビュー日程確保 |
| 用語の合意が取れない | 最小限から始め、後で拡充 |

---

## Phase 2: 要件整備（Week 3-6）

### 目標
- MVP Level 2 達成
- 主要機能の仕様が明文化

### タスク

#### Week 3-4
- [ ] Glossary拡充（30用語目標）
  - invariants追加
  - Value Objects追加
- [ ] 主要User Stories作成開始
  - 対象機能: [機能名]

#### Week 5-6
- [ ] User Stories完成（10個）
- [ ] 外部API OpenAPI仕様作成
- [ ] Phase 2 レビュー会議

### 成果物
- [ ] domain/glossary.yaml（30用語）
- [ ] requirements/user-stories.md
- [ ] api-specs/external-api.yaml

### マイルストーン
- [ ] MVP Level 2 達成

---

## Phase 3: 設計明文化（Week 7-12）

### 目標
- MVP Level 3 達成
- リファクタリングの基盤完成

### タスク

#### Week 7-8
- [ ] Domain Model 抽出・文書化
  - 対象Aggregate: [名前]
- [ ] インタビュー実施（設計判断の背景）

#### Week 9-10
- [ ] Domain Events 定義
- [ ] Event Flow 図作成
- [ ] ADR作成開始

#### Week 11-12
- [ ] ADR完成（5件以上）
- [ ] 技術的負債カタログ作成
- [ ] Phase 3 レビュー会議

### 成果物
- [ ] domain-design/domain-model.ts
- [ ] domain-design/events/
- [ ] adr/ADR-001〜005

### マイルストーン
- [ ] MVP Level 3 達成

---

## Phase 4: 継続的改善（Week 13〜）

### 目標
- 文書化プラクティスの定着
- 継続的な改善サイクルの確立

### 定常タスク（各スプリント）
- [ ] 新機能開発時のUser Story作成
- [ ] Glossary更新（新用語追加）
- [ ] ADR追加（設計判断時）

### 月次タスク
- [ ] Glossary一貫性チェック
- [ ] ドキュメント-コード乖離確認
- [ ] 技術的負債レビュー

### 四半期タスク
- [ ] 全体レビュー会議
- [ ] ロードマップ見直し
- [ ] 成熟度再評価

---

## 成功基準

### MVP Level 1 達成基準
- [ ] 新メンバーがDomain Visionを読んで概要を理解できる
- [ ] Glossaryの用語がコード内の命名と一致している
- [ ] Context Mapがシステム全体像を示している

### MVP Level 2 達成基準
- [ ] 主要機能のUser Storiesが存在する
- [ ] 外部APIの仕様書が最新である
- [ ] Glossaryで主要エンティティがすべてカバーされている

### MVP Level 3 達成基準
- [ ] Domain Modelが実装と一致している
- [ ] 主要な設計判断がADRとして記録されている
- [ ] 技術的負債が可視化されている

---

## リソース計画

| 役割 | 週あたり時間 | 担当者 |
|------|--------------|--------|
| 文書化リード | 8-10h | [名前] |
| レビュアー | 2-3h | [名前] |
| ドメインエキスパート | 2h（インタビュー） | [名前] |
| 開発者（貢献） | 1-2h | 全員 |
```

---

## 日常業務への組み込み

### PRレビュー時のチェック

```markdown
## PR文書化チェックリスト

### 新機能追加時
- [ ] 新しい用語はGlossaryに追加したか？
- [ ] User StoryのAC更新が必要か？
- [ ] API変更はOpenAPI仕様に反映したか？

### リファクタリング時
- [ ] Domain Model の変更は文書に反映したか？
- [ ] ADRが必要な設計判断をしたか？

### バグ修正時
- [ ] 不足していたinvariantはないか？
- [ ] ACに漏れていたケースはないか？
```

### スプリント計画への組み込み

```markdown
## スプリント計画での文書化考慮

### Definition of Done（DoD）に追加
- [ ] 新機能: 関連するGlossary/User Story更新済み
- [ ] API変更: OpenAPI仕様更新済み
- [ ] 設計判断: ADR作成済み

### 見積もり時の考慮
- 新用語導入: +0.5h（Glossary更新）
- API追加: +1h（OpenAPI更新）
- 設計判断: +2h（ADR作成）
```

### 定期レビューの設定

```markdown
## 文書化レビュースケジュール

### 週次（15分）
- Glossary/コード命名の乖離チェック
- 今週追加されたADRの共有

### 月次（1時間）
- 全体的な文書-コード一貫性レビュー
- 技術的負債の棚卸し
- 次月の文書化優先度確認

### 四半期（2時間）
- 成熟度再評価
- ロードマップ見直し
- チームフィードバック収集
```

---

## よくある障害と対策

| 障害 | 症状 | 対策 |
|------|------|------|
| 時間がない | 文書化が後回しになる | DoDに組み込み、PRでブロック |
| 誰が書くか不明 | お見合い状態 | 担当者を明示、ローテーション |
| 価値が見えない | モチベーション低下 | 成功体験を共有（オンボーディング短縮等） |
| 更新されない | ドキュメントが陳腐化 | CI/CDでチェック、PRレビューに組み込み |
| 完璧主義 | 着手できない | MVPを明確に、「まず出す」文化 |

---

## 次のステップ

- 診断から始める → [gap-analysis.md](gap-analysis.md)
- コードから抽出する → [reverse-engineering.md](reverse-engineering.md)
- 暗黙知を収集する → [knowledge-extraction.md](knowledge-extraction.md)
- 新規プロジェクト向け → [../SKILL.md](../SKILL.md)
